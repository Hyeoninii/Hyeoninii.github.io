---
layout: post
title: "[μ›Ήλ³΄μ•] CSRF κ³µκ²©"
categories: [λ„¤νΈμ›ν¬ λ° μ›Ήλ³΄μ•]
tags: [λ³΄μ•, μ›Ήλ³΄μ•, CSRF]
date: 2025-03-22 17:30:00 +0900
last_modified_at: 2025-03-22
---

# CSRFλ€?

> CSRF(Cross Site Request Forgery, μ‚¬μ΄νΈ κ°„ μ”μ²­ μ„μ΅°)λ€ μ‚¬μ©μκ°€ νΉμ • μ›Ήμ‚¬μ΄νΈμ— λ΅κ·ΈμΈν• μƒνƒμ—μ„, μ•…μ„± μ›Ήμ‚¬μ΄νΈλ¥Ό λ°©λ¬Έν•λ©΄ μ‚¬μ©μμ μλ„μ™€ κ΄€κ³„μ—†μ΄ μ”μ²­μ΄ μ „μ†΅λλ” κ³µκ²© κΈ°λ²•μ΄λ‹¤.


## CSRF κ³µκ²© μ›λ¦¬
1. μ‚¬μ©μκ°€ A μ‚¬μ΄νΈ(μ: μΈν„°λ„· λ±…ν‚Ή)μ— λ΅κ·ΈμΈν•κ³  μ„Έμ…μ„ μ μ§€
2. κ³µκ²©μκ°€ A μ‚¬μ΄νΈλ¥Ό λ¨λ°©ν•μ—¬ μ•…μ„±μ½”λ“λ¥Ό μ¶”κ°€ν• B μ‚¬μ΄νΈλ¥Ό μƒμ„±
3. μ‚¬μ©μκ°€ λ§ν¬λ¥Ό ν†µν•΄ B μ‚¬μ΄νΈλ¥Ό λ°©λ¬Έν•λ©΄ μλ™μΌλ΅ A μ‚¬μ΄νΈλ΅ μ”μ²­μ΄ μ „μ†΅λ¨
4. A μ‚¬μ΄νΈλ” μ΄λ¥Ό μ •μƒμ μΈ μ”μ²­μΌλ΅ μ¤μΈν•κ³  μ²λ¦¬ν•¨.


## CSRF κ³µκ²© μμ‹

> HTTPλ” GET μ”μ²­κ³Ό POST μ”μ²­μΌλ΅ μ„λ²„μ— μ”μ²­μ„ λ³΄λ‚Έλ‹¤.

### 1οΈβƒ£ GET μ”μ²­μ„ μ΄μ©ν• κ³µκ²©
`Samy`κ°€ `Alice`λ¥Ό μΉκµ¬ μ¶”κ°€λ¥Ό ν•κ³  μ‹¶λ‹¤κ³  μƒκ°ν•΄λ³΄μ

`Samy`λ΅ μ ‘μ†ν•μ—¬ `Alice`μ—κ² μΉκµ¬ μ¶”κ°€ μ”μ²­μ„ λ³΄λ‚΄λ³΄λ©΄ `http://www.seed-server.com/action/friends/add?friend=56 &~~` μ™€ κ°™μ΄ URLλ’¤μ— `friend=56`κ³Ό κ°™μ΄ λ³€μ κ°’μ΄ λ¶™μ–΄μ„ κ°€λ” κ²ƒμ„ ν™•μΈν•  μ μλ‹¤. 

![GETμ”μ²­ μ‚¬μ§„](/assets/img/post_image/2025-03-22/sc1.png)

κ·Έλ ‡κΈ° λ•λ¬Έμ— κ³µκ²©μλ” β€http://www.seed-server.com/action/friends/add?friend=5

### 2οΈβƒ£ POST μ”μ²­μ„ μ΄μ©ν• κ³µκ²©


π”’ CSRF λ°©μ–΄ λ°©λ²•

β… 1. CSRF ν† ν° μ‚¬μ©

μ„λ²„κ°€ μ”μ²­μ„ λ°›μ„ λ•, μ„Έμ…κ³Ό μ—°κ²°λ CSRF ν† ν°μ΄ ν•¨κ» μ „μ†΅λμ—λ”μ§€ κ²€μ¦ν•λ‹¤.

<input type="hidden" name="csrf_token" value="abcd1234">

μ„λ²„λ” μ”μ²­μ—μ„ λ°›μ€ csrf_tokenκ³Ό μ €μ¥λ ν† ν°μ„ λΉ„κµν•μ—¬ μΌμΉν•μ§€ μ•μΌλ©΄ μ”μ²­μ„ μ°¨λ‹¨ν•λ‹¤.

β… 2. SameSite μΏ ν‚¤ μ„¤μ •

SameSite μ†μ„±μ„ ν™μ©ν•μ—¬ μ™Έλ¶€ μ‚¬μ΄νΈμ—μ„ μΏ ν‚¤λ¥Ό μ „μ†΅ν•μ§€ μ•λ„λ΅ μ„¤μ •ν•  μ μλ‹¤.

Set-Cookie: sessionid=abcd1234; HttpOnly; Secure; SameSite=Strict

Strict: μ™„μ „ν μ™Έλ¶€ μ”μ²­ μ°¨λ‹¨ (λ³΄μ• κ°•λ ¥)

Lax: GET μ”μ²­μ€ ν—μ©ν•μ§€λ§, μ¤‘μ”ν• λ³€κ²½ μ”μ²­(POST λ“±)μ€ μ°¨λ‹¨

β… 3. Referer / Origin κ²€μ¦

μ„λ²„μ—μ„ μ”μ²­μ Referer λλ” Originμ„ ν™•μΈν•μ—¬ μ‹ λΆ°ν•  μ μλ” μ¶μ²μ—μ„ μ¨ μ”μ²­μΈμ§€ κ²€μ‚¬ν•  μ μλ‹¤.

if request.headers["Origin"] != "https://bank.com":
    reject_request()

β… 4. CORS μ •μ±… κ°•ν™”

CORS(Cross-Origin Resource Sharing) μ •μ±…μ„ μ—„κ²©ν•κ² μ„¤μ •ν•μ—¬, μ™Έλ¶€ μ‚¬μ΄νΈμ—μ„ μ¤‘μ” μ”μ²­μ„ λ³΄λ‚Ό μ μ—†λ„λ΅ μ ν•ν•  μ μλ‹¤.

Access-Control-Allow-Origin: https://trusted-site.com





